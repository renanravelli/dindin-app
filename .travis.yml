language: java
script:
  - mvn versions:set -DremoveSnapshot=true -DgenerateBackupPoms=false
  - mvn flyway:migrate clean install deploy
  - mvn --batch-mode release:update-versions -DnextSnapshot -DgenerateBackupPoms=false
  - mvn versions:commit
  - git pull origin $TRAVIS_BRANCH && git push origin $TRAVIS_BRANCH
  - git add . && git commit "Travis-ci - new version generated"
  - git push origin $TRAVIS_BRANCH
branches:
  only:
    - master
    - desen
jdk:
  - oraclejdk11
deploy:
  provider: heroku
  app: dindin-app
  access_key_id: $HEROKU_ID
  api_key: $HEROKU_TOKEN
  skip_cleanup: true
  on:
    repo: renanravelli/dindin-app
    branch: desen
notifications:
  email: false
cache:
  directories:
    - $HOME/.m2
